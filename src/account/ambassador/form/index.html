<!DOCTYPE html>
<a href="./signin.html" session="false" hidden></a>

<style>
    .accordion-button {
        width: 100%;
        background-color: #fff;
        cursor: pointer;
        padding: 18px;
        border-top: 1px solid #ddd;
        text-align: left;
    }

    .form {
        padding: 18px;
        overflow: hidden;
        background-color: #f9f9f9;
        display: none;
    }

    #individual {
        display: none;
    }

    .forms[business="individual"] #individual {
        display: block;
    }

    .forms[display="account"] account.form {
        display: block;
    }
    .forms[display="individual"] individual.form {
        display: flex;
    }
    /* .forms[display="individual"] company.form {
        display: none;
    } */
    .forms[display="company"] company.form {
        display: flex;
    }
    .forms[display="bank-account"] bank-account.form {
        display: flex;
    }
    .forms[display="documents"] documents.form {
        display: flex;
    }
</style>

<form
    array="users"
    object="$user_id"
    class="forms width:100% max-width:800px"
    module="stripe">
    <input
        type="hidden"
        array="users"
        object="$user_id"
        key="ambassadorAccount"
        stripe="accounts.update"
        stripe-key="$param[0]" />

    <div
        class="display:flex justify-content:space-between align-items:center font-size:20px width:100%">
        <a
            actions="state"
            state_to="mainView"
            state-src="./account/ambassador/"
            class="padding:0px_10px"
            ><i src="./assets/svg/angle-left.svg"></i
        ></a>
    </div>

    <div class="accordion-item">
        <div
            class="accordion-button"
            click-closest=".forms"
            click-attribute="display"
            click-value="account">
            Account
        </div>
        <!-- Account -->
        <account
            class="form width:100% display:flex flex-wrap:wrap gap:15px"
            src="account/ambassador/form/account.html">
        </account>
    </div>

    <div id="individual" class="accordion-item">
        <div
            class="accordion-button"
            click-closest=".forms"
            click-attribute="display"
            click-value="individual">
            Individual
        </div>
        <!-- Individual -->
        <individual
            class="form width:100% display:flex flex-wrap:wrap gap:15px"
            src="account/ambassador/form/individual.html">
        </individual>
    </div>
    <div class="accordion-item">
        <div
            class="accordion-button"
            click-closest=".forms"
            click-attribute="display"
            click-value="company">
            Company
        </div>

        <!-- Comapny -->
        <company
            class="form width:100% display:flex flex-wrap:wrap gap:15px"
            src="account/ambassador/form/company.html">
        </company>
    </div>
    <div class="accordion-item">
        <div
            class="accordion-button"
            click-closest=".forms"
            click-attribute="display"
            click-value="bank-account">
            Bank Account
        </div>

        <!-- External Account -->
        <bank-account
            class="form width:100% display:flex flex-wrap:wrap gap:15px"
            src="account/ambassador/form/bank-account.html">
        </bank-account>
    </div>
    <div class="accordion-item">
        <div
            class="accordion-button"
            click-closest=".forms"
            click-attribute="display"
            click-value="documents">
            Documents
        </div>

        <!-- Documents -->
        <documents
            class="form width:100% display:flex flex-wrap:wrap gap:15px"
            src="account/ambassador/form/documents.html">
        </documents>
    </div>

    <button
        actions="validate, save, stripe.accounts.update, state"
        state_to="mainView"
        state-src="./account/ambassador/"
        class="width:100% margin-top:20px">
        Save
    </button>
</form>

<div class="position:fixed!important bottom:15px right:15px z-index:2">
    <div
        template="validate, stripe.accounts"
        class="card position:fixed!important bottom:15px right:15px padding:10px {{status}}">
        <span class="{{type}}">{{message}}</span><a actions="remove"> X</a>
    </div>
</div>

<script>
    (function () {
        CoCreate.observer.init({
            name: "setEmailInput",
            observe: ["addedNodes"],
            target: "[value='$ip']",
            callback: async (mutation) => {
                fetch("https://api.ipify.org?format=json")
                    .then((response) => response.json())
                    .then((data) => {
                        mutation.target.value = data.ip;
                    });
            },
        });
    })();
</script>
