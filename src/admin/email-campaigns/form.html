<!DOCTYPE html>
<a href="./signin.html" session="false" hidden></a>

<section class="centered flex-direction:column">
	<form
		id="email-campaigns"
		state_id="email-campaigns"
		array="email-campaigns"
		object=""
		class="flex-form">
		<!-- Toolbar Component -->
		<div
			path="./"
			src="./components/form-toolbar.html"
			class="width:100%"></div>

		<!-- Frendily Name -->
		<floating-label class="input-300">
			<input
				type="type"
				key="name"
				placeholder="Email Name"
				class="floating-label" />
		</floating-label>

		<!-- Schedule Field (Optional) -->
		<floating-label class="input-300">
			<input
				type="datetime-local"
				key="schedule"
				placeholder="Schedule Send Time"
				class="floating-label" />
		</floating-label>

		<!-- Subject Field -->
		<floating-label class="input-600">
			<input
				type="text"
				key="subject"
				placeholder="Email Subject"
				class="floating-label" />
		</floating-label>

		<!-- Contact list Field -->
		<floating-label class="input-300">
			<select id="contactList" key="recipients" class="floating-label">
				<option value="" disabled selected>
					Select Recipient Type
				</option>
				<option value="newsletter">Newsletter</option>
				<option value="all">All</option>
				<option value="subscribed">Subscribed</option>
				<option value="not-subscribed">Not Subscribed</option>
			</select>
		</floating-label>

		<!-- Template Field -->
		<floating-label class="input-300">
			<select id="tempalte" key="template" class="floating-label">
				<option value="" disabled selected>Select Template</option>
				<option value="newsletter">Newsletter</option>
				<option value="subscribed">Subscribed</option>
				<option value="not-subscribed">Not Subscribed</option>
			</select>
		</floating-label>

		<!-- Content Field -->
		<!-- <floating-label class="input-600">
			<textarea
				id="email-content"
				contenteditable="true"
				key="content"
				placeholder="Email Content"
				class="floating-label"
				height="auto"></textarea>
		</floating-label> -->

		<floating-label class="input-600">
			<div
				class="playground display:flex flex-direction:column position:relative overflow:hidden border-radius:2px width:auto height:600px">
				<div
					resizable
					class="playground-code position:relative height:50%">
					<textarea
						type="code"
						lang="html"
						key="content"
						input-closest=".playground .preview"
						input-attribute="value"
						input-events="input, onload"
						class="height:100% width:100% outline:none border:none resize:none padding:5px"></textarea>
					<div resize="bottom" class="background:lightgrey"></div>
				</div>

				<div class="playground-preview position:relative overflow:auto">
					<iframe class="preview width:100% height:100%"></iframe>
				</div>

				<div
					class="display:flex gap:15px font-size:20px position:absolute top:10px right:10px opacity:0.6">
					<a
						click-closest=".playground"
						click-value="hide-preview"
						click-attribute="class">
						<i
							toggle-attribute="src"
							toggle-value="/assets/svg/eye-slash.svg, /assets/svg/eye.svg"
							src="/assets/svg/eye.svg"></i>
					</a>
					<a
						click-closest=".playground"
						click-value="hide-code"
						click-attribute="class">
						<i
							toggle-attribute="src"
							toggle-value="/assets/svg/code.svg, /assets/svg/code.svg"
							src="/assets/svg/code.svg"></i>
					</a>
					<a
						class="margin-right:5px"
						fullscreen
						fullscreen-closest=".playground">
						<i src="/assets/svg/expand.svg"></i>
						<i src="/assets/svg/compress.svg"></i>
					</a>
				</div>
			</div>
		</floating-label>

		<!-- <floating-label class="input-600">
			<iframe
				id="email-content"
				contenteditable="true"
				key="content"
				realtime="true"
				placeholder="Email Content"
				class="floating-label rich-text-editor"
				height="auto"
				src="./admin/email-campaigns/templates/newsletter.html"></iframe>
		</floating-label> -->

		<!-- Hidden Metadata Fields -->
		<input
			key="_id"
			input-selector="document; #sendform"
			input-attribute="object"
			hidden />
		<input type="datetime" key="created_at" value="$now" hidden />

		<!-- Save Button -->
		<button actions="save" class="button-round">
			<i src="./assets/svg/save.svg"></i>
		</button>

		<!-- Send Newsletter Button -->
		<button
			click-selector="i[src]"
			click-attribute="src"
			click-value="./assets/svg/spinner.svg"
			actions="click, save, sendMassEmails">
			Send Emails
			<i id="emailSent-icon" src="./assets/svg/paper-plane.svg"></i>
		</button>
	</form>

	<!-- Optional: OpenAI Integration for Content Generation -->
	<form>
		<input
			openai="chat.completions.create"
			openai-key="model"
			value="gpt-4-1106-preview"
			hidden />

		<input
			openai="chat.completions.create"
			openai-key="messages[0].role"
			value="system"
			hidden />
		<textarea
			array="ai"
			object
			key="content"
			filter-key="name"
			filter-value="Newsletter Content"
			openai="chat.completions.create"
			openai-key="messages[0].content"
			hidden></textarea>

		<input
			openai="chat.completions.create"
			openai-key="messages[1].role"
			value="user"
			hidden />
		<input
			class="title"
			openai="chat.completions.create"
			openai-key="messages[1].content"
			hidden />

		<textarea
			id="input"
			openai="chat.completions.create"
			openai-key="choices[0].message.content"
			openai-request="false"
			marked
			input-selector="document; #email-content"
			input-attribute="value"
			hidden></textarea>
		<a
			id="generate-content"
			actions="openai.chat.completions.create, action(document; #generate-details)"></a>
	</form>

	<div src="./components/toolbar.html" value-type="outerHTML"></div>
</section>

<script src="./admin/email-campaigns/index.js"></script>
